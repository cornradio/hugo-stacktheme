---
title: 网络常识 # 标题
slug: netword-must-know # url(注释掉 和标题相同)
image: network.jpg # 头图，注释掉，否则会有一个难看的呃加载不出来的图片
# description: xxxx # 描述小字(注释掉 不显示描述)

date: 2024-06-03 00:00:00+0000 # 日期时间，如果时间未到，post 不会显示(注释掉 不显示日期)
# weight: 1 # 权重越小，放到越前面   (注释掉 日期排序)

# tags: # 只能在侧面看到的标签,会显示在文章的底部
#     - TAG A
#     - TAG B
# categories: #会显示在 post 上面的分类
#     - themes
#     - syntax
---

上个周末,我买了一个 open wrt 路由器,由于配网总是把家里的网配瘫痪, 我去恶补了一下相关网络的常识。  
包括IP地址、子网掩码、网关、DNS和DHCP，他们都是家庭网络的重要组成部分。  
讲解有些拟人化，并且对实际情况进行了简化，但是好理解!  

希望能对新手小白提供一些帮助吧(希望没有误导他们hhh)

----

### IP   : IP 地址 
类似你家居住地址，其他的设备知道电脑的 IP 地址才能给你发消息。
比如 `翻斗花园小区一号102`
在计算机的话看起来就是 `54.178.170.154` 类似这样

### mask ：子网掩码
这涉及到内网、外网的意义  ， 你必须理解这个概念 ：`网络的网络` 

1. 最开始的时候网络非常的小，只要用网线把这些机器连在一起（连到一台交换机上）就 ok 了
2. 如果 `1.1.1.1` 要去寻找 `1.1.1.2` 的话 ，就直接把数据丢过去。
3. 后来这个网络越来越大了，交换机他的脑子记不住，然后他就死机了，大家都上不了网了。
4. 于是人们把网络分成一小块一小块的，然后再连在一起，路由器处理这些连起来的交换机数据该往哪里发的问题，就是现在的这种网络。
5. 子网掩码就是用来标记网络范围大小用的，好让网络设备知道，哪块是内网，哪块是外网，交换机才知道往哪边丢。
6. 对家用路由器来说来说 Wan = 外网 ，Lan = 内网 ， 简单来说就是只要知道这个数据是外网, 就统统的丢给WAN

常见的子网掩码如下  
**/8：** 255.0.0.0  
**/16：** 255.255.0.0  
**/24：** 255.255.255.0  

--- 

举个例子 

```
cidr：192.168.1.2/24 
相当于
ip：192.168.1.2
mask：255.255.255.0
相当于：
192.168.1.x 都是内网，其他ip地址都是外面
```


### gate 网关
网关（Gateway）是一种路由器，它连接不同的网络。

举个例子 

你的电脑ip
```
ip：192.168.1.2
mask：255.255.255.0
gate：192.168.1.1
```

1. 如你要访问 `baidu.com [39.156.66.10]`
2. 你的电脑用自己的 ip、mask 一计算，“耶？这个好像不是内网ip地址呀，得出网了，丢给网关gate”
3. 你的电脑 把访问包发给了 `gate：192.168.1.1` 然后gate一看目的ip就懂了，然后把包丢到外网去了。

所以你的网关是 你的电脑和外网（相对于内网）沟通的重要渠道，如果配置错了网关，每次出网包都会出不去，导致你上不了网

### DNS  
你电脑通过 dns 服务器,来获取到域名的 IP 地址, 一般 dns 默认就是网关，虽然网关自己可能不会dns，但是他会转发啊。

举个例子 
1. 你的电脑联网之后，第一次使访问 baidu.com
2. 电脑不知道 baidu.com  IP 地址是什么,于是问网关：“ 帮我查一下 dns baidu.com  IP 地址是什么”
3. 假设你的网关不知道  baidu.com  IP 地址是什么 , 他就会继续向上找其他的dns服务器，直到获取到一个 IP 地址再返回给你 `查到了 dns , baidu.com  IP 是 xx.xx.xx.xx`
4. 
### DNS 的 TTL 
1. 电脑已经最近 访问过 baidu.com 并且记住了他的 IP 地址
2. 浏览器访问 baidu.com , 就不需要再询问 dns 记录了,他就直接用缓存里记忆中的 IP 地址来访问
3. 公共 DNS 服务器：一般的 ttl 是 12-24 小时
4. 假设一天过去了，ttl 结束之后，电脑就会主动忘记这个 IP 地址，然后重新进行dns查询
5. 如果你希望手动重新查询，就使用 ctrl + F5 强制刷新网站

### DHCP 
在古老的时代，IP mask gate  都需要网络管理员来手动分配。  
后来他们觉得这实在是太傻逼了，工作量好大呀。  
就有人发明了DHCP 这个东西，路由器(开启了 dhcp 的网关), 对新来的设备会自动分配合理的 IP mask gate，网络管理员就可以坐在那里喝饮料吹空调了.  
 - DHCP 请求是客户端设备主动发出的，并且是广播请求，相当于拿个喇叭对整个屋子的人喊`谁来给我个 IP 地址啊`
 - 一般一个网络中 只允许存在 **一个DHCP服务器**. 其实很好理解 , 如果你拿个喇叭问 `谁来给我个 IP 地址啊` , 然后有好几个人都给你分配了**不一样的 IP 地址**你到底该听谁的呢? 
 - (比如在家庭网络中 你家有好几个路由器 , 可以把主路由的 DHCP 功能关掉 , 然后让子路由开启DHCP功能 ， 我要保证整个网络中只存在一个 DHCP 服务器就可以了，这就是旁路由)
---
- DHCP服务器 会给设备分配IP(随便找一个空的IP) mask(与DHCP服务器相同) gate(DHCP服务器自己的 IP)
- DHCP release ， DHCP服务器 在分配 IP 的时候， 会给设备一个租期， 意思是对设备说`超过了这个租期你这个 IP 就不能用了` 
- DHCP renew ，客户端在快要到期的时候，如果还在网络内，一般会主动的和 DHCP服务器 说：`我要续租，把这个 IP 还是继续留给我吧，我再租一天的`，DHCP服务器总是回复 `好的呢`



就这些了，写不动了，感觉写的也一般，这东西很难说明白。  
