<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content=" 批量ping是我的工作中常常需要用到的功能了，但是手动好麻烦！我在网上找到了一个脚本，经过了一些改进现在非常好用了，为了方便自己以后复制和互联网精神，我把它放在这里！\n特点 多个IP并行扫描，速度很快 扫描py代码所在目录下所有.txt文件，对每个txt文件内的所有IP进行扫描（会自动判断行内容是不是ip哦！目前只支持ipv4） 输出上色，更容易看清 输出使用tab分割，可以轻松复制到excel进行排序筛选之类的操作 代码 import subprocess import multiprocessing import time def check_alive(ip): result = subprocess.call(f'ping -w 1000 -n 2 {ip}', stdout=subprocess.PIPE, shell=True) # 等待超时时间1000ms ， 测试次数 2次 if result == 0: h = subprocess.getoutput('ping ' + ip) returnnum = h.split('平均 = ')[1] print(f'{ip}\\t\\033[32m[ok]\\033[0m\\t{returnnum}\\t'.replace(&#34;\\n&#34;,&#34;&#34;) ) else: print(f'{ip}\\t\\033[31m[bad]\\033[0m'.replace(&#34;\\n&#34;,&#34;&#34;)) if __name__ == '__main__': print('结果使用tab分隔，可以拷贝到excel中，通过数据透视进行ip排序等') # 获取所有当前目录下的txt文件并存入 txtfile_list import os path = &#34;.&#34; file_name_list = os.listdir(path) txtfile_list = [] for x in file_name_list: if x.__contains__('.'): if x.split('.')[1] == &#34;txt&#34;: txtfile_list.append(x) print(txtfile_list) MUTIPROCESS = True for x in txtfile_list: print(f&#34;scaning {x} :&#34;) # input(&#34;enter 开始ping&#34;) with open(x, 'r') as f: # xxx.txt 内容应该包含ip地址，每行一个，可以写备注因为下面会 print(f'ipaddress\\t[ok]\\tlatency\\t'.replace(&#34;\\n&#34;, &#34;&#34;)) for line in f: # 识别ip地址 if len(line.split('.')) == 4: if MUTIPROCESS: # 多线程模式 p = multiprocessing.Process(target=check_alive, args=(line,)) p.start() else: #单线程模式 check_alive(line) # 展示非ip行内容 # else: print(line) # 等待多线程数量为0（ping均结束）后开启下一个txt的扫描 while True: if len(multiprocessing.active_children()) == 0: # print('thread count: '+ str(len(multiprocessing.active_children())) +' ,scan complete\\n\\n') print(&#34;------------&#34;) break time.sleep(3) 使用效果 为了避免信息泄露，我这里放的都是一些网络上的服务器，很少…… 不过我正常使用这个工具的时候都是搞几十个ip来扫\n"><title>使用python多线程批量ping</title><link rel=canonical href=https://b.cornradio.org/p/%E4%BD%BF%E7%94%A8python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%B9%E9%87%8Fping/><link rel=stylesheet href=/scss/style.min.8eadf3f3164ccb6a96b30adea68a160508f995a247316864e595d31ca96abb70.css><meta property='og:title' content="使用python多线程批量ping"><meta property='og:description' content=" 批量ping是我的工作中常常需要用到的功能了，但是手动好麻烦！我在网上找到了一个脚本，经过了一些改进现在非常好用了，为了方便自己以后复制和互联网精神，我把它放在这里！\n特点 多个IP并行扫描，速度很快 扫描py代码所在目录下所有.txt文件，对每个txt文件内的所有IP进行扫描（会自动判断行内容是不是ip哦！目前只支持ipv4） 输出上色，更容易看清 输出使用tab分割，可以轻松复制到excel进行排序筛选之类的操作 代码 import subprocess import multiprocessing import time def check_alive(ip): result = subprocess.call(f'ping -w 1000 -n 2 {ip}', stdout=subprocess.PIPE, shell=True) # 等待超时时间1000ms ， 测试次数 2次 if result == 0: h = subprocess.getoutput('ping ' + ip) returnnum = h.split('平均 = ')[1] print(f'{ip}\\t\\033[32m[ok]\\033[0m\\t{returnnum}\\t'.replace(&#34;\\n&#34;,&#34;&#34;) ) else: print(f'{ip}\\t\\033[31m[bad]\\033[0m'.replace(&#34;\\n&#34;,&#34;&#34;)) if __name__ == '__main__': print('结果使用tab分隔，可以拷贝到excel中，通过数据透视进行ip排序等') # 获取所有当前目录下的txt文件并存入 txtfile_list import os path = &#34;.&#34; file_name_list = os.listdir(path) txtfile_list = [] for x in file_name_list: if x.__contains__('.'): if x.split('.')[1] == &#34;txt&#34;: txtfile_list.append(x) print(txtfile_list) MUTIPROCESS = True for x in txtfile_list: print(f&#34;scaning {x} :&#34;) # input(&#34;enter 开始ping&#34;) with open(x, 'r') as f: # xxx.txt 内容应该包含ip地址，每行一个，可以写备注因为下面会 print(f'ipaddress\\t[ok]\\tlatency\\t'.replace(&#34;\\n&#34;, &#34;&#34;)) for line in f: # 识别ip地址 if len(line.split('.')) == 4: if MUTIPROCESS: # 多线程模式 p = multiprocessing.Process(target=check_alive, args=(line,)) p.start() else: #单线程模式 check_alive(line) # 展示非ip行内容 # else: print(line) # 等待多线程数量为0（ping均结束）后开启下一个txt的扫描 while True: if len(multiprocessing.active_children()) == 0: # print('thread count: '+ str(len(multiprocessing.active_children())) +' ,scan complete\\n\\n') print(&#34;------------&#34;) break time.sleep(3) 使用效果 为了避免信息泄露，我这里放的都是一些网络上的服务器，很少…… 不过我正常使用这个工具的时候都是搞几十个ip来扫\n"><meta property='og:url' content='https://b.cornradio.org/p/%E4%BD%BF%E7%94%A8python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%B9%E9%87%8Fping/'><meta property='og:site_name' content><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='python'><meta property='article:tag' content='Network'><meta property='article:published_time' content='2022-06-18T19:53:02+08:00'><meta property='article:modified_time' content='2022-06-18T19:53:02+08:00'><meta name=twitter:title content="使用python多线程批量ping"><meta name=twitter:description content=" 批量ping是我的工作中常常需要用到的功能了，但是手动好麻烦！我在网上找到了一个脚本，经过了一些改进现在非常好用了，为了方便自己以后复制和互联网精神，我把它放在这里！\n特点 多个IP并行扫描，速度很快 扫描py代码所在目录下所有.txt文件，对每个txt文件内的所有IP进行扫描（会自动判断行内容是不是ip哦！目前只支持ipv4） 输出上色，更容易看清 输出使用tab分割，可以轻松复制到excel进行排序筛选之类的操作 代码 import subprocess import multiprocessing import time def check_alive(ip): result = subprocess.call(f'ping -w 1000 -n 2 {ip}', stdout=subprocess.PIPE, shell=True) # 等待超时时间1000ms ， 测试次数 2次 if result == 0: h = subprocess.getoutput('ping ' + ip) returnnum = h.split('平均 = ')[1] print(f'{ip}\\t\\033[32m[ok]\\033[0m\\t{returnnum}\\t'.replace(&#34;\\n&#34;,&#34;&#34;) ) else: print(f'{ip}\\t\\033[31m[bad]\\033[0m'.replace(&#34;\\n&#34;,&#34;&#34;)) if __name__ == '__main__': print('结果使用tab分隔，可以拷贝到excel中，通过数据透视进行ip排序等') # 获取所有当前目录下的txt文件并存入 txtfile_list import os path = &#34;.&#34; file_name_list = os.listdir(path) txtfile_list = [] for x in file_name_list: if x.__contains__('.'): if x.split('.')[1] == &#34;txt&#34;: txtfile_list.append(x) print(txtfile_list) MUTIPROCESS = True for x in txtfile_list: print(f&#34;scaning {x} :&#34;) # input(&#34;enter 开始ping&#34;) with open(x, 'r') as f: # xxx.txt 内容应该包含ip地址，每行一个，可以写备注因为下面会 print(f'ipaddress\\t[ok]\\tlatency\\t'.replace(&#34;\\n&#34;, &#34;&#34;)) for line in f: # 识别ip地址 if len(line.split('.')) == 4: if MUTIPROCESS: # 多线程模式 p = multiprocessing.Process(target=check_alive, args=(line,)) p.start() else: #单线程模式 check_alive(line) # 展示非ip行内容 # else: print(line) # 等待多线程数量为0（ping均结束）后开启下一个txt的扫描 while True: if len(multiprocessing.active_children()) == 0: # print('thread count: '+ str(len(multiprocessing.active_children())) +' ,scan complete\\n\\n') print(&#34;------------&#34;) break time.sleep(3) 使用效果 为了避免信息泄露，我这里放的都是一些网络上的服务器，很少…… 不过我正常使用这个工具的时候都是搞几十个ip来扫\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_671728dc471b2c78.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/></a></h1><h2 class=site-description>本站使用imgur图床，需要科学上网方可查看图片</h2></div></header><ol class=menu-social><li><a href=https://appstore.cornradio.org/ target=_blank title=AppStore rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-shopping-bag"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6.331 8H17.67a2 2 0 011.977 2.304l-1.255 8.152A3 3 0 0115.426 21H8.574a3 3 0 01-2.965-2.544l-1.255-8.152A2 2 0 016.331 8z"/><path d="M9 11V6a3 3 0 016 0v5"/></svg></a></li><li><a href=/clock target=_blank title="online clock" rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-clock-hour-4"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1018 0A9 9 0 103 12"/><path d="M12 12l3 2"/><path d="M12 7v5"/></svg></a></li><li><a href=/index.xml target=_blank title=rss rel=me><svg class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li><li><a href=http://139.196.171.60/watchTV/a-plan/ target=_blank title="watchtv 139" rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-screen-share"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M21 12v3a1 1 0 01-1 1H4a1 1 0 01-1-1V5a1 1 0 011-1h9"/><path d="M7 20h10"/><path d="M9 16v4"/><path d="M15 16v4"/><path d="M17 4h4v4"/><path d="M16 9l5-5"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/friends-links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Friends Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E4%BD%BF%E7%94%A8python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%89%B9%E9%87%8Fping/>使用python多线程批量ping</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jun 18, 2022</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>1 minute read</time></div></footer></div></header><section class=article-content><blockquote><p>批量ping是我的工作中常常需要用到的功能了，但是手动好麻烦！我在网上找到了一个脚本，经过了一些改进现在非常好用了，为了方便自己以后复制和互联网精神，我把它放在这里！</p></blockquote><h1 id=特点>特点</h1><ul><li>多个IP并行扫描，速度很快</li><li>扫描py代码所在目录下所有<code>.txt</code>文件，对每个txt文件内的所有IP进行扫描（会自动判断行内容是不是ip哦！目前只支持ipv4）</li><li>输出上色，更容易看清</li><li>输出使用tab分割，可以轻松复制到excel进行排序筛选之类的操作</li></ul><h1 id=代码>代码</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>multiprocessing</span>
</span></span><span class=line><span class=cl><span class=kn>import</span>  <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check_alive</span><span class=p>(</span><span class=n>ip</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>call</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;ping -w 1000 -n 2 </span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 等待超时时间1000ms ， 测试次数 2次</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>result</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>h</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>getoutput</span><span class=p>(</span><span class=s1>&#39;ping &#39;</span> <span class=o>+</span> <span class=n>ip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>returnnum</span> <span class=o>=</span> <span class=n>h</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;平均 = &#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=se>\t\033</span><span class=s1>[32m[ok]</span><span class=se>\033</span><span class=s1>[0m</span><span class=se>\t</span><span class=si>{</span><span class=n>returnnum</span><span class=si>}</span><span class=se>\t</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;&#34;</span><span class=p>)</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>ip</span><span class=si>}</span><span class=se>\t\033</span><span class=s1>[31m[bad]</span><span class=se>\033</span><span class=s1>[0m&#39;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span><span class=s2>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;结果使用tab分隔，可以拷贝到excel中，通过数据透视进行ip排序等&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 获取所有当前目录下的txt文件并存入 txtfile_list</span>
</span></span><span class=line><span class=cl>    <span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>    <span class=n>path</span> <span class=o>=</span> <span class=s2>&#34;.&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>file_name_list</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>txtfile_list</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>file_name_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>x</span><span class=o>.</span><span class=fm>__contains__</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>x</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;txt&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>txtfile_list</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>txtfile_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>MUTIPROCESS</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>txtfile_list</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;scaning </span><span class=si>{</span><span class=n>x</span><span class=si>}</span><span class=s2> :&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=c1># input(&#34;enter 开始ping&#34;)</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>  <span class=c1># xxx.txt 内容应该包含ip地址，每行一个，可以写备注因为下面会</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;ipaddress</span><span class=se>\t</span><span class=s1>[ok]</span><span class=se>\t</span><span class=s1>latency</span><span class=se>\t</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># 识别ip地址</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>))</span> <span class=o>==</span> <span class=mi>4</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>MUTIPROCESS</span><span class=p>:</span> <span class=c1># 多线程模式</span>
</span></span><span class=line><span class=cl>                        <span class=n>p</span> <span class=o>=</span> <span class=n>multiprocessing</span><span class=o>.</span><span class=n>Process</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=n>check_alive</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=n>line</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>                        <span class=n>p</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                    <span class=k>else</span><span class=p>:</span> <span class=c1>#单线程模式</span>
</span></span><span class=line><span class=cl>                        <span class=n>check_alive</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=c1># 展示非ip行内容</span>
</span></span><span class=line><span class=cl>                <span class=c1># else:   print(line)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 等待多线程数量为0（ping均结束）后开启下一个txt的扫描</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>multiprocessing</span><span class=o>.</span><span class=n>active_children</span><span class=p>())</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># print(&#39;thread count: &#39;+ str(len(multiprocessing.active_children())) +&#39; ,scan complete\n\n&#39;)</span>
</span></span><span class=line><span class=cl>                <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;------------&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>break</span>
</span></span><span class=line><span class=cl>            <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span>
</span></span></code></pre></div><h1 id=使用效果>使用效果</h1><p>为了避免信息泄露，我这里放的都是一些网络上的服务器，很少……
不过我正常使用这个工具的时候都是搞几十个ip来扫</p><p><img src="https://image.baidu.com/search/down?url=https://tvax2.sinaimg.cn/large/006rgJELgy1h3cncasc0qj319g0raano.jpg" loading=lazy alt=image>
<img src="https://image.baidu.com/search/down?url=https://tva2.sinaimg.cn/large/006rgJELgy1h3cnhgy70yj30fq0cjdi1.jpg" loading=lazy alt=image></p><h1 id=尾巴>尾巴</h1><p>其实我是周末弄得啦，之前就是直接用的网上搜到的版本，但是总是感觉不好用，今天正好有空，就修改了一下。</p><p>无论是输出的排版、还是多个txt的支持之类的，我的版本都是比较好的啦！</p><p>如果说你有超级多个ip进行测试的话，你可能会发现有的时候一行输出了2个ip，然后下面还有个空行，那也是我很想解决（但是也不会弄）的东西，因为他们是并行开始ping的，没有办法知道他们测试结束的时间，如果他们的结束后print的时间正好卡在一起那就一行两个了。</p><p>不过目前也可以通过复制到excel里面然后把很明显串行的结果剪切过去来解决……但是 一点也不优雅！</p></section><footer class=article-footer><section class=article-tags><a href=/tags/python/>Python</a>
<a href=/tags/network/>Network</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/pandas/><div class=article-image><img src=/pandas.jpg loading=lazy data-key data-hash=/pandas.jpg></div><div class=article-details><h2 class=article-title>Pandas</h2></div></a></article><article class=has-image><a href=/p/python-json-config/><div class=article-image><img src=/py-json.png loading=lazy data-key data-hash=/py-json.png></div><div class=article-details><h2 class=article-title>python json config</h2></div></a></article><article><a href=/p/python-win-%E5%AE%89%E8%A3%85/><div class=article-details><h2 class=article-title>Python Win 安装</h2></div></a></article><article><a href=/p/%E5%A6%82%E4%BD%95%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E5%92%8C%E6%9B%B4%E6%96%B0pip%E5%8C%85/><div class=article-details><h2 class=article-title>如何一键安装和更新pip包</h2></div></a></article><article><a href=/p/%E5%A6%82%E4%BD%95%E6%8A%8A-python-%E7%A8%8B%E5%BA%8F%E6%89%93%E5%8C%85%E6%88%90-exe/><div class=article-details><h2 class=article-title>如何把 Python 程序打包成 exe</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=cornradio/blog-comments issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
1998 -
2025</section><section class=powerby>爱分享<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>